{"version":3,"sources":["esm.mjs"],"sourcesContent":["import fs from 'fs';\nimport path from 'path';\nimport Queue from 'queue-cb';\nimport rimraf2 from 'rimraf2';\nimport { transformDirectory } from 'ts-swc-transform';\n\nimport { source } from 'tsds-lib';\n\nexport default function esm(_args, options, cb) {\n  const cwd = options.cwd || process.cwd();\n  options = { ...options };\n  options.type = 'esm';\n  options.sourceMaps = true;\n  options.dest = path.join(cwd, 'dist', 'esm');\n  rimraf2(options.dest, { disableGlob: true }, () => {\n    const src = source(options);\n    const srcDir = path.dirname(path.resolve(cwd, src));\n\n    const queue = new Queue(1);\n    queue.defer(transformDirectory.bind(null, srcDir, options.dest, 'esm', options));\n    queue.defer(fs.writeFile.bind(null, path.join(options.dest, 'package.json'), '{\"type\":\"module\"}'));\n    queue.await(cb);\n  });\n}\n"],"names":["esm","_args","options","cb","cwd","process","type","sourceMaps","dest","path","join","rimraf2","disableGlob","src","source","srcDir","dirname","resolve","queue","Queue","defer","transformDirectory","bind","fs","writeFile","await"],"mappings":";;;;+BAQA;;;eAAwBA;;;yDART;2DACE;8DACC;8DACE;8BACe;uBAEZ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAER,SAASA,IAAIC,KAAK,EAAEC,OAAO,EAAEC,EAAE;IAC5C,IAAMC,MAAMF,QAAQE,GAAG,IAAIC,QAAQD,GAAG;IACtCF,UAAU,mBAAKA;IACfA,QAAQI,IAAI,GAAG;IACfJ,QAAQK,UAAU,GAAG;IACrBL,QAAQM,IAAI,GAAGC,aAAI,CAACC,IAAI,CAACN,KAAK,QAAQ;IACtCO,IAAAA,gBAAO,EAACT,QAAQM,IAAI,EAAE;QAAEI,aAAa;IAAK,GAAG;QAC3C,IAAMC,MAAMC,IAAAA,eAAM,EAACZ;QACnB,IAAMa,SAASN,aAAI,CAACO,OAAO,CAACP,aAAI,CAACQ,OAAO,CAACb,KAAKS;QAE9C,IAAMK,QAAQ,IAAIC,gBAAK,CAAC;QACxBD,MAAME,KAAK,CAACC,kCAAkB,CAACC,IAAI,CAAC,MAAMP,QAAQb,QAAQM,IAAI,EAAE,OAAON;QACvEgB,MAAME,KAAK,CAACG,WAAE,CAACC,SAAS,CAACF,IAAI,CAAC,MAAMb,aAAI,CAACC,IAAI,CAACR,QAAQM,IAAI,EAAE,iBAAiB;QAC7EU,MAAMO,KAAK,CAACtB;IACd;AACF"}