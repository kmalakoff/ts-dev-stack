{"version":3,"sources":["esm.js"],"sourcesContent":["const fs = require('fs');\nconst path = require('path');\nconst Queue = require('queue-cb');\nconst rimraf2 = require('rimraf2');\nconst { transformDirectory } = require('ts-swc-transform');\n\nconst { source } = require('tsds-lib');\n\nmodule.exports = function esm(_args, options, cb) {\n  const cwd = options.cwd || process.cwd();\n  options = { ...options };\n  options.type = 'esm';\n  options.sourceMaps = true;\n  options.dest = path.join(cwd, 'dist', 'esm');\n  rimraf2(options.dest, { disableGlob: true }, () => {\n    const src = source(options);\n    const srcDir = path.dirname(path.resolve(cwd, src));\n\n    const queue = new Queue(1);\n    queue.defer(transformDirectory.bind(null, srcDir, options.dest, 'esm', options));\n    queue.defer(fs.writeFile.bind(null, path.join(options.dest, 'package.json'), '{\"type\":\"module\"}'));\n    queue.await(cb);\n  });\n};\n"],"names":["fs","require","path","Queue","rimraf2","transformDirectory","source","module","exports","esm","_args","options","cb","cwd","process","type","sourceMaps","dest","join","disableGlob","src","srcDir","dirname","resolve","queue","defer","bind","writeFile","await"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA,IAAMA,KAAKC,QAAQ;AACnB,IAAMC,OAAOD,QAAQ;AACrB,IAAME,QAAQF,QAAQ;AACtB,IAAMG,UAAUH,QAAQ;AACxB,IAAM,AAAEI,qBAAuBJ,QAAQ,oBAA/BI;AAER,IAAM,AAAEC,SAAWL,QAAQ,YAAnBK;AAERC,OAAOC,OAAO,GAAG,SAASC,IAAIC,KAAK,EAAEC,OAAO,EAAEC,EAAE;IAC9C,IAAMC,MAAMF,QAAQE,GAAG,IAAIC,QAAQD,GAAG;IACtCF,UAAU,mBAAKA;IACfA,QAAQI,IAAI,GAAG;IACfJ,QAAQK,UAAU,GAAG;IACrBL,QAAQM,IAAI,GAAGf,KAAKgB,IAAI,CAACL,KAAK,QAAQ;IACtCT,QAAQO,QAAQM,IAAI,EAAE;QAAEE,aAAa;IAAK,GAAG;QAC3C,IAAMC,MAAMd,OAAOK;QACnB,IAAMU,SAASnB,KAAKoB,OAAO,CAACpB,KAAKqB,OAAO,CAACV,KAAKO;QAE9C,IAAMI,QAAQ,IAAIrB,MAAM;QACxBqB,MAAMC,KAAK,CAACpB,mBAAmBqB,IAAI,CAAC,MAAML,QAAQV,QAAQM,IAAI,EAAE,OAAON;QACvEa,MAAMC,KAAK,CAACzB,GAAG2B,SAAS,CAACD,IAAI,CAAC,MAAMxB,KAAKgB,IAAI,CAACP,QAAQM,IAAI,EAAE,iBAAiB;QAC7EO,MAAMI,KAAK,CAAChB;IACd;AACF"}