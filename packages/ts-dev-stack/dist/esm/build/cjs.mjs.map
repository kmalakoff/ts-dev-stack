{"version":3,"sources":["cjs.mjs"],"sourcesContent":["import fs from 'fs';\nimport path from 'path';\nimport Queue from 'queue-cb';\nimport rimraf2 from 'rimraf2';\nimport { transformDirectory } from 'ts-swc-transform';\n\nimport { source } from 'tsds-lib';\n\nexport default function cjs(_args, options, cb) {\n  const cwd = options.cwd || process.cwd();\n  options = { ...options };\n  options.type = 'cjs';\n  options.sourceMaps = true;\n  options.dest = path.join(cwd, 'dist', 'cjs');\n  rimraf2(options.dest, { disableGlob: true }, () => {\n    const src = source(options);\n    const srcDir = path.dirname(path.resolve(cwd, src));\n\n    const queue = new Queue(1);\n    queue.defer(transformDirectory.bind(null, srcDir, options.dest, 'cjs', options));\n    queue.defer(fs.writeFile.bind(null, path.join(options.dest, 'package.json'), '{\"type\":\"commonjs\"}'));\n    queue.await(cb);\n  });\n}\n"],"names":["fs","path","Queue","rimraf2","transformDirectory","source","cjs","_args","options","cb","cwd","process","type","sourceMaps","dest","join","disableGlob","src","srcDir","dirname","resolve","queue","defer","bind","writeFile","await"],"mappings":"AAAA,OAAOA,QAAQ,KAAK;AACpB,OAAOC,UAAU,OAAO;AACxB,OAAOC,WAAW,WAAW;AAC7B,OAAOC,aAAa,UAAU;AAC9B,SAASC,kBAAkB,QAAQ,mBAAmB;AAEtD,SAASC,MAAM,QAAQ,WAAW;AAElC,eAAe,SAASC,IAAIC,KAAK,EAAEC,OAAO,EAAEC,EAAE;IAC5C,MAAMC,MAAMF,QAAQE,GAAG,IAAIC,QAAQD,GAAG;IACtCF,UAAU;QAAE,GAAGA,OAAO;IAAC;IACvBA,QAAQI,IAAI,GAAG;IACfJ,QAAQK,UAAU,GAAG;IACrBL,QAAQM,IAAI,GAAGb,KAAKc,IAAI,CAACL,KAAK,QAAQ;IACtCP,QAAQK,QAAQM,IAAI,EAAE;QAAEE,aAAa;IAAK,GAAG;QAC3C,MAAMC,MAAMZ,OAAOG;QACnB,MAAMU,SAASjB,KAAKkB,OAAO,CAAClB,KAAKmB,OAAO,CAACV,KAAKO;QAE9C,MAAMI,QAAQ,IAAInB,MAAM;QACxBmB,MAAMC,KAAK,CAAClB,mBAAmBmB,IAAI,CAAC,MAAML,QAAQV,QAAQM,IAAI,EAAE,OAAON;QACvEa,MAAMC,KAAK,CAACtB,GAAGwB,SAAS,CAACD,IAAI,CAAC,MAAMtB,KAAKc,IAAI,CAACP,QAAQM,IAAI,EAAE,iBAAiB;QAC7EO,MAAMI,KAAK,CAAChB;IACd;AACF"}